const __vite__fileDeps=["assets/EditTransaction-CmlpZzkr.js","assets/index-BId5unLI.js","assets/index-C2hKCJDb.css","assets/VContainer-WgC0LsUa.js","assets/VContainer-CndwlDRC.css","assets/VCard-C9GPxSST.js","assets/VCard-BGihEtQu.css","assets/VRow-X4mf2N83.js","assets/EditTransaction-eUjNdxnE.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as H,r as T,c as K,g as Q,u as W,a as X,b as S,w as Z,e as x,o as h,f as ee,h as n,i as r,j as y,t as m,k as o,l as k,m as E,n as U,V as ae,p as te,q as se,s as le,_ as ne}from"./index-BId5unLI.js";import{d as v,u as oe,V as re,a as $,b as ue,c as ie,e as de}from"./VContainer-WgC0LsUa.js";import{V,a as C}from"./VRow-X4mf2N83.js";const O=window.localStorage,ce=H("user",()=>{const D=T(JSON.parse(O.getItem("User")||"{}")),i=T(JSON.parse(O.getItem("Funds")||'{"value": 0}'));return{user:D,funds:i,setFunds:d=>{i.value=d?parseFloat(d):null,i.updated_at=new Date().toISOString(),O.setItem("Funds",JSON.stringify(i))}}});var I={exports:{}};(function(D,i){(function(M,d){D.exports=d()})(K,function(){return function(M,d){d.prototype.isSameOrAfter=function(_,f){return this.isSame(_,f)||this.isAfter(_,f)}}})})(I);var fe=I.exports;const me=Q(fe),ve={class:"text-h4"},pe={key:0,class:"text-body-1 mt-1"},ye={key:1,class:"text-caption"},_e={class:"text-h5 mb-2"},be={key:0,class:"text-success"},ge={key:1,class:"text-error"},xe={class:"text-center py-2"},he=y("div",null,"Can't budget without any transactions!",-1),Ye={__name:"BudgetView",setup(D){v.extend(me);const i=ce(),M=oe();W();const{mobile:d,md:_}=X(),{commaNumber:f}=de(),j=le(()=>ne(()=>import("./EditTransaction-CmlpZzkr.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),Y=S({});Z(()=>i.funds,s=>Y.value=s,{immediate:!0});const w=x(()=>{var s;return(s=i.funds)!=null&&s.updated_at?v(i.funds.updated_at).format("MMMM DD, YYYY"):null}),J=()=>i.setFunds(Y.value.value),b=S(v().startOf("day")),B=S(60),A=x(()=>b.value.add(parseInt(B.value||0)+1,"days").startOf("day")),p=x(()=>{const s=[];M.transactionsList.forEach(a=>{let l=a.end_date?v(a.end_date):null;if(l&&l.isBefore(b.value))return;let u=v(a.start_date);if(!a.interval_value&&u.isBefore(b.value)||u.isSameOrAfter(A.value))return;if(a.interval_value){let N=Math.floor(u.diff(b.value,a.interval));if(N>0){let G=Math.floor(N/a.interval_value);u=u.add(G+a.interval_value,a.interval)}}const{id:F,name:z,value:L,sign:q}=a;for(;u.isBefore(A.value)&&u.isSameOrAfter(b.value)&&(!l||l&&u.isBefore(l))&&(s.push({id:`${F}-${u.format("YYYY-MM-DD")}`,tansaction_id:F,name:z,value:L,sign:q,day:u}),!!a.interval_value);)u=u.add(a.interval_value,a.interval)}),s.sort((a,l)=>a.day.isSame(l.day,"day")?0:a.day.isBefore(l.day)?-1:1);let t=parseFloat(i.funds.value)||0;const e=s.length;for(let a=0;a<e;a++){let l=s[a];t+=l.value*l.sign,l.balance=t,l.day=l.day.toDate(),l.index=a}return s}),P=x(()=>p.value.length),R=[{title:"Date",key:"day"},{title:"Name",key:"name",sortable:!1},{title:"Amount",key:"value",sortable:!1},{title:"Balance",key:"balance",sortable:!1}],c=x(()=>{let s=p.value[0];p.value.forEach(e=>{e.balance<s.balance&&(s=e)});let t=s?p.value[s.index+1]:null;if(t)for(let e=t.index;e<P.value;e++){let a=p.value[e];a.balance<t.balance&&(t=a)}return[s,t]}),g=S(!1);return(s,t)=>(h(),ee(re,{fluid:""},{default:n(()=>[r(C,{class:"mt-2"},{default:n(()=>[r(V,null,{default:n(()=>{var e;return[y("div",ve,"Your Budget: "+m(o(f)((e=c.value[0])==null?void 0:e.balance)),1),c.value[0]?(h(),k("div",pe,"until "+m(o(v)(c.value[0].day).format("ddd, MMMM DD, YYYY")),1)):E("",!0),c.value[0]&&c.value[1]&&c.value[0].day!=c.value[1].day?(h(),k("div",ye,"then "+m(o(f)(c.value[1].balance))+" until "+m(o(v)(c.value[1].day).format("ddd, MMMM DD, YYYY")),1)):E("",!0)]}),_:1}),r(V,{class:"d-flex align-center",cols:o(d)?12:o(_)?4:3},{default:n(()=>[r($,{label:"Current Funds",modelValue:Y.value.value,"onUpdate:modelValue":t[0]||(t[0]=e=>Y.value.value=e),type:"number",min:1,"prepend-icon":"mdi-cash-multiple",onChange:J,density:"default",hint:`Updated ${w.value}`,"persistent-hint":!!w.value},null,8,["modelValue","hint","persistent-hint"])]),_:1},8,["cols"])]),_:1}),r(C,null,{default:n(()=>[r(V,null,{default:n(()=>[r(ue,{items:p.value,headers:R,"sort-by":[{key:"day",order:"asc"}],sticky:"",density:"compact"},{top:n(()=>[r(C,{class:"mb-2"},{default:n(()=>[r(V,{class:"d-flex align-start"},{default:n(()=>[y("div",_e,[U("Upcoming Transactions"),r(ae,{class:"ml-2",icon:"mdi-plus",onClick:t[1]||(t[1]=e=>g.value=!0),size:"small",variant:"text"})])]),_:1}),r(V,{class:"d-flex align-start",cols:o(d)?12:o(_)?4:3},{default:n(()=>[r($,{label:"Budget Days",modelValue:B.value,"onUpdate:modelValue":t[2]||(t[2]=e=>B.value=e),type:"number","prepend-icon":"mdi-calendar-month"},null,8,["modelValue"])]),_:1},8,["cols"])]),_:1})]),"item.day":n(({item:e})=>[U(m(o(v)(e.day).format("ddd, MMMM DD, YYYY")),1)]),"item.value":n(({item:e})=>[e.sign==1?(h(),k("div",be,"+ "+m(o(f)(e.value)),1)):(h(),k("div",ge,"- "+m(o(f)(e.value)),1))]),"item.balance":n(({item:e})=>[y("span",{class:te(e.balance<0?"text-error":null)},m(o(f)(e.balance)),3)]),"no-data":n(()=>[y("div",xe,[he,y("a",{href:"",onClick:t[3]||(t[3]=se(e=>g.value=!0,["prevent"]))},"Add one")])]),_:1},8,["items"])]),_:1})]),_:1}),r(ie,{modelValue:g.value,"onUpdate:modelValue":t[5]||(t[5]=e=>g.value=e),persistent:"",fullscreen:o(d),transition:o(d)?"dialog-bottom-transition":"dialog-transition"},{default:n(()=>[r(o(j),{class:"mx-auto",item:{},onClose:t[4]||(t[4]=e=>g.value=!1)})]),_:1},8,["modelValue","fullscreen","transition"])]),_:1}))}};export{Ye as default};
