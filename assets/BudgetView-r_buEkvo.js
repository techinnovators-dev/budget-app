const __vite__fileDeps=["assets/EditTransaction-cAEonf6H.js","assets/index-G8Rl6dVg.js","assets/index-BUgSi1mf.css","assets/VContainer-DcZ2kRQY.js","assets/VContainer-CndwlDRC.css","assets/VCard-BQ_AytSh.js","assets/VCard-BGihEtQu.css","assets/VRow-D-GzrhA2.js","assets/EditTransaction-eUjNdxnE.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as J,r as O,c as P,g as R,u as z,a as w,w as L,b as V,o as g,e as G,f as n,h as r,i as f,t as m,j as u,k as A,V as q,l as C,n as H,m as K,p as Q,_ as W}from"./index-G8Rl6dVg.js";import{d as c,u as X,V as Z,a as ee,b as ae,c as te,e as se}from"./VContainer-DcZ2kRQY.js";import{V as S,a as F}from"./VRow-D-GzrhA2.js";const x=window.localStorage,ne=J("user",()=>{const _=O(JSON.parse(x.getItem("User")||"{}")),o=O(JSON.parse(x.getItem("Funds")||'{"value": 0}'));return{user:_,funds:o,setFunds:l=>{o.value=l?parseFloat(l):null,o.updated_at=new Date().toISOString(),x.setItem("Funds",JSON.stringify(o))}}});var E={exports:{}};(function(_,o){(function(y,l){_.exports=l()})(P,function(){return function(y,l){l.prototype.isSameOrAfter=function(h,d){return this.isSame(h,d)||this.isAfter(h,d)}}})})(E);var oe=E.exports;const le=R(oe),re={class:"text-h4"},ie={class:"text-body-1 mt-1"},de={class:"text-h5 mb-2"},ue={key:0,class:"text-success"},ce={key:1,class:"text-error"},fe={class:"text-center py-2"},me=f("div",null,"Can't budget without any transactions!",-1),ye={__name:"BudgetView",setup(_){c.extend(le);const o=ne(),y=X();z();const{commaNumber:l}=se(),h=Q(()=>W(()=>import("./EditTransaction-cAEonf6H.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),d=w({});L(()=>o.funds,t=>d.value=t,{immediate:!0});const D=V(()=>{var t;return(t=o.funds)!=null&&t.updated_at?c(o.funds.updated_at).format("MMMM DD, YYYY"):null}),T=()=>o.setFunds(d.value.value),v=c().startOf("day"),M=v.add(61,"days").startOf("day"),b=V(()=>{const t=[];y.transactionsList.forEach(e=>{let i=e.end_date?c(e.end_date):null;if(i&&i.isBefore(v))return;let s=c(e.start_date);if(!e.interval_value&&s.isBefore(v)||s.isSameOrAfter(M))return;if(e.interval_value){let B=Math.floor(s.diff(v,e.interval));if(B>0){let j=Math.floor(B/e.interval_value);s=s.add(j+e.interval_value,e.interval)}}const{id:k,name:U,value:$,sign:I}=e;for(;s.isBefore(M)&&s.isSameOrAfter(v)&&(!e.end_date||s.isBefore(i))&&(t.push({id:`${k}-${s.format("YYYY-MM-DD")}`,tansaction_id:k,name:U,value:$,sign:I,day:s}),!!e.interval_value);)s=s.add(e.interval_value,e.interval)}),t.sort((e,i)=>e.day.isSame(i.day,"day")?0:e.day.isBefore(i.day)?-1:1);let a=parseFloat(o.funds.value)||0;return t.forEach(e=>{a+=e.value*e.sign,e.balance=a,e.day=e.day.toDate()}),t}),N=[{title:"Date",key:"day"},{title:"Name",key:"name",sortable:!1},{title:"Amount",key:"value",sortable:!1},{title:"Balance",key:"balance",sortable:!1}],Y=V(()=>{let t=b.value[0];return b.value.forEach(a=>{a.balance<t.balance&&(t=a)}),t}),p=w(!1);return(t,a)=>(g(),G(Z,{fluid:""},{default:n(()=>[r(F,{class:"mt-2"},{default:n(()=>[r(S,null,{default:n(()=>{var e,i;return[f("div",re,"Your Budget: "+m(u(l)((e=Y.value)==null?void 0:e.balance)),1),f("div",ie,"until "+m(u(c)((i=Y.value)==null?void 0:i.day).format("ddd, MMMM DD, YYYY")),1)]}),_:1}),r(S,{cols:"3"},{default:n(()=>[r(ee,{label:"Current Funds",modelValue:d.value.value,"onUpdate:modelValue":a[0]||(a[0]=e=>d.value.value=e),"prepend-icon":"mdi-cash-multiple",onChange:T,hint:`Updated ${D.value}`,"persistent-hint":!!D.value,"hide-details":"auto",type:"number"},null,8,["modelValue","hint","persistent-hint"])]),_:1})]),_:1}),r(F,null,{default:n(()=>[r(S,null,{default:n(()=>[r(ae,{items:b.value,headers:N,"sort-by":[{key:"day",order:"asc"}],sticky:"",density:"compact"},{top:n(()=>[f("div",de,[A("Upcoming Transactions"),r(q,{class:"ml-2",icon:"mdi-plus",onClick:a[1]||(a[1]=e=>p.value=!0),size:"small",variant:"text"})])]),"item.day":n(({item:e})=>[A(m(u(c)(e.day).format("ddd, MMMM DD, YYYY")),1)]),"item.value":n(({item:e})=>[e.sign==1?(g(),C("div",ue,"+ "+m(u(l)(e.value)),1)):(g(),C("div",ce,"- "+m(u(l)(e.value)),1))]),"item.balance":n(({item:e})=>[f("span",{class:H(e.balance<0?"text-error":null)},m(u(l)(e.balance)),3)]),"no-data":n(()=>[f("div",fe,[me,f("a",{href:"",onClick:a[2]||(a[2]=K(e=>p.value=!0,["prevent"]))},"Add one")])]),_:1},8,["items"])]),_:1})]),_:1}),r(te,{modelValue:p.value,"onUpdate:modelValue":a[4]||(a[4]=e=>p.value=e),persistent:""},{default:n(()=>[r(u(h),{class:"mx-auto",item:{},onClose:a[3]||(a[3]=e=>p.value=!1)})]),_:1},8,["modelValue"])]),_:1}))}};export{ye as default};
